# BiVAE-CPI

BiVAE-CPI: Predicting compound-protein interaction based on latent representations generated by bilateral variational autoencoder

# Requirements

python==3.9

numpy==1.21.5

padas==1.2.4

rdkit==2023.3.1

scikit_learn==1.1.2

torch==1.12.1

networkx==3.0

# Example usage

## 1. data process

Get the interaction matrix from the dataset and other data information. The dataset parameter can be modified to represent different datasets.

The code only has original data. If you need unbalanced data, you need to modify the path and run the code to generate the corresponding dataset.

```python
# Run the commandline
python data_process.py
```

## 2. Specify hyperparameters

There are many hyperparameters of the model (i.g. learning rate, batch size, epochs, step size, weight decay, gin_layers, latent_dim). For more information, see source code of main.py.

## 3. Train model

Execute the main.py file to train the model. Hyperparameters can be modifed from the source code. Here is a usage example.

```python
# Run the commandline
python main.py -dataset human -lr 0.0005 -k 20 -encoder_structure=[40] -likelihood='pois' -gin_layers=3
```

## 4. Run on your datasets

Dataset includes train.txt and test.txt file, and store them in the corresponding paths. Each line in the data file contains the SMILES of the compound, the amino acid sequence of the protein, and the predicted label. The format of the data file is as follows:

```
CC(C)C1=NN2C=CC=CC2=C1C(=O)C(C)C,MVDEDKKSGTRVFKKTSPNGKITTYLGKRDFIDRGDYVDLIDGMVLIDEEYIKDNRKVTAHLLAAFRYGREDLDVLGLTFRKDLISETFQVYPQTDKSISRPLSRLQERLKRKLGANAFPFWFEVAPKSASSVTLQPAPGDTGKPCGVDYELKTFVAVTDGSSGEKPKKSALSNTVRLAIRKLTYAPFESRPQPMVDVSKYFMMSSGLLHMEVSLDKEMYYHGESISVNVHIQNNSNKTVKKLKIYIIQVADICLFTTASYSCEVARIESNEGFPVGPGGTLSKVFAVCPLLSNNKDKRGLALDGQLKHEDTNLASSTILDSKTSKESLGIVVQYRVKVRAVLGPLNGELFAELPFTLTHSKPPESPERTDRGLPSIEATNGSEPVDIDLIQLHEELEPRYDDDLIFEDFARMRLHGNDSEDQPSPSANLPPSLL,0
C1=CC=C2C(=C1)N=C(S2)C(C#N)C3=NC(=NC=C3)NCCC4=CN=CC=C4,MFRQEILNEVLFIVPNRYVDLLPSQFGNAMEVIAFDQISERRVVIKKVVLPENFDNWQHWRRAQRELFCTLHIQEENFVKMYSIYTWVETVEEMREFYTVREYMDWNLRNFILSTPEKLDHKVIKSIFFDVCLAVQYMHSIRVGHRDLKPENVLINYEAIAKISGFAHANREDPFVNTPYIVQRFYRAPEILCETMDNNKPSVDIWSLGCILAELLTGKILFTGQTQIDQFFQIVRFLGNPDLSFYMQMPDSARTFFLGLPMNQYQKPTNIHEHFPNSLFLDTMISEPIDCDLARDLLFRMLVINPDDRIDIQKILVHPYLEEVWSNIVIDNKIEEKYPPIALRRFFEFQAFSPPRQMKDEIFSTLTEFGQQYNIFNNSRN,1
...
```

